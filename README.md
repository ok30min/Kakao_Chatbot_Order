# Kakao_Chatbot_Order

#### 카카오 i 오픈빌더를 사용하여 카카오톡 기반의 대화형 챗봇 인터페이스를 개발하였으며, 카카오페이를 사용하여 결제가 이루어질 수 있도록 하였습니다.   
#### 챗봇 서버와 카카오페이 서버를 연동시키기 위해 아마존에서 제공하는 서버리스 컴퓨텅 서비스인 AWS Lambda를 사용하였고, 고객 데이터 관리를 위해 DynamoDB를 사용했습니다.

## 개발 언어
  - Python
  - NodeJS
  
## 개발 플랫폼
  - AWS Lambda
  - Kakao i open builder
  - AWS DynamoDB

<hr/>

## 1. sign_up.py
#### 챗봇에서 사용자가 입력한 핸드폰 번호를 AWS Lambda에서 받아와 DynamoDB에 저장하는 코드입니다.

<hr/>

## 2. point_lookup.py
#### AWS Lambda에서 챗봇에서 사용자가 입력한 핸드폰 번호에 대한 정보를 입력받아 DynamoDB에 저장되어있는 사용자의 누적 포인트 값을 조회하는 코드입니다.

<hr/>

## 3. general_payment_preprocess.py
#### 해당 코드는 결제가 이뤄지기 전, 총 결제 금액을 계산하기 위한 코드입니다.   
#### 챗봇에서 사용자가 주문정보(메뉴 / 수량 / 핸드폰 번호)를 입력하게 되면 이에 따른 총 결제금액과 결제 후 적립될 포인트가 코드 내에서 계산되고, 계산된 값이 챗봇으로 사용자에게 전달됩니다.   
#### 이후 사용자는 챗봇 발화에서 최종적으로 결제 여부를 선택하게 됩니다.

  - 총 결제 금액 = 가격 * 수량
  - 적립될 포인트 = 총 결제 금액 * 0.1

<hr/>

## 4. point_payment_preprocess.py
#### 해당 코드는 포인트를 사용하여 결제를 하기위해 작성된 코드이며 general_payment_preprocess.py와 비슷한 구성을 띄고 있습니다.   
#### 차이점은 사용자가 입력한 핸드폰 번호를 DynamoDB에서 조회하여 누적된 포인트 값을 불러온다. 이후 사용할 만큼의 포인트를 차감하고 최종 결제 금액을 챗봇으로 사용자에게 전달합니다.
  - 총 결제 금액 = 가격 * 수량
  - 최종 결제 금액 = 총 결제금액 - 사용할 포인트     

#### 이후 사용자는 챗봇 발화에서 최종적으로 결제 여부를 선택하게 됩니다.

<hr/>

## 5. payment.js
#### 해당 코드는 사용자가 챗봇에서 최종적으로 결제를 승인했을 때, 실행되는 코드입니다.   
#### 카카오페이에 주문 정보를 넘겨주고, 테스트 결제 URL을 실행시킵니다.

<hr/>


